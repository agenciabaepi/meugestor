name: Lembretes Automáticos

on:
  schedule:
    # Executa a cada 5 minutos
    # Formato: minuto hora dia mês dia-da-semana
    # */5 * * * * = a cada 5 minutos
    - cron: '*/5 * * * *'
  # Permite executar manualmente no GitHub (Actions > Lembretes Automáticos > Run workflow)
  workflow_dispatch:

jobs:
  lembrete:
    runs-on: ubuntu-latest
    steps:
      - name: Executar Lembretes
        run: |
          # Substitua a URL abaixo pelo seu domínio real da Vercel
          URL="https://meugestor.vercel.app/api/cron/lembretes"
          
          # Se você configurou CRON_SECRET, descomente as linhas abaixo
          # e adicione CRON_SECRET como secret no GitHub (Settings > Secrets and variables > Actions)
          # if [ -n "${{ secrets.CRON_SECRET }}" ]; then
          #   curl -X GET "$URL" \
          #     -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
          #     -H "Content-Type: application/json"
          # else
            curl -X GET "$URL" \
              -H "Content-Type: application/json" \
              -w "\nStatus: %{http_code}\n"
          # fi
          
          echo "✅ Lembrete executado com sucesso!"
